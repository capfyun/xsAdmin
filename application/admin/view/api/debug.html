
{extend name="layout/base" /}

{block name="content"}
<div class="row">
	<div class="col-md-12">
		<div class="box ">
			<form class="form-horizontal" method="post" action="{:url()}" onsubmit="return page.debugStart(this);">
				<div class="box-body">
					<input name="api_id" type="hidden" value="{:input('api_id')}" />
					<fieldset >
						<legend>接口信息</legend>
						<div class="form-group">
							<label class="col-sm-2 control-label">名称</label>
							<div class="col-sm-10">
								<input name="" value="{$info.name ?? ''}" type="text" readonly class="form-control" placeholder="">
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-2 control-label">地址</label>
							<div class="col-sm-10">
								<input name="" value="{$info.url ?? ''}" type="text" readonly class="form-control" placeholder="">
							</div>
						</div>
						<div class="form-group">
							<label  class="col-sm-2 control-label">作者</label>
							<div class="col-sm-10">
								<input name="" value="{$info.author ?? ''}" type="text" readonly class="form-control" placeholder="">
							</div>
						</div>
						<div class="form-group">
							<label  class="col-sm-2 control-label">加密</label>
							<div class="col-sm-10">
								<input name="" value="{$info.is_encrypt ? '是' : '否'}" type="text" readonly class="form-control" placeholder="">
							</div>
						</div>
						<div class="form-group">
							<label  class="col-sm-2 control-label">描述</label>
							<div class="col-sm-10">
								<textarea name="" class="form-control" rows="6" readonly placeholder="">{$info.description ?? ''}</textarea>
							</div>
						</div>
					</fieldset>

					<fieldset >
						<legend>接口参数</legend>
					{volist name="info.param" id="vo"}
					{assign name="$explain" value="$info['explain'][$vo] ? : []" /}
					<div class="form-group">
						<label  class="col-sm-2 control-label">{$vo}</label>
						<div class="col-sm-10">
							<input name="{$vo}" value="{:session($vo,'','api')}" type="text" class="form-control" placeholder="">
							<span class="help-block">
								{$explain['title'] ? '【'.$explain['title'].'】' : ''}{$explain['rule'] ?? ''}{$explain['explain'] ? '（'.$explain['explain'].'）' : ''}
							</span>
						</div>
					</div>
					{/volist}
					</fieldset>

					<fieldset >
						<legend>处理结果</legend>
						<div class="form-group">
							<label  class="col-sm-2 control-label">返回数据</label>
							<div class="col-sm-10">
								<textarea name="" id="result" class="form-control" rows="16" readonly placeholder=""></textarea>
							</div>
						</div>
					</fieldset>

				</div>
				<div class="box-footer">
					<button type="submit" class="btn btn-primary">Submit</button>
					<button type="button" class="btn btn-default" onclick="window.history.back();" >Cancel</button>
				</div>
			</form>
		</div>
	</div>
</div>

<script type="text/javascript">
	$(function(){
	});

	var page = {
		/**
		 * 接口调试请求
		 */
		debugStart 			: function(form){
//		if(admin.loading == true){ return false; } admin.loading = true;
			var $form 	= $(form);
			$.post($form.attr("action"),$form.serialize(),function(data){
				try {
					if(typeof JSON == 'object'){
						$form.find('#result').val(JSON.stringify(JSON.parse(data), null, "    "));
					}else{
						$form.find('#result').val( jsl.format.formatJson(data) );
					}
				} catch(e) {
					$form.find('#result').val( data );
					app.alert('接口出错：'+e);
				}
//			admin.loading = false;
			});
			return false;
		},
	};

</script>
{/block}

